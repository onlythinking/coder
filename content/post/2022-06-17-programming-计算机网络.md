---
title: "编程基础知识之计算机网络 | 编程码农"
date: "2022-06-17T14:00:43+08:00"
description: "概述 网络 网络由两台或多台计算机组成，它们相互连接后共享资源、交换文件或进行电子通信。网络上的计算机可以通过电缆、电话线、无线电波、卫星或红外光束连接起来。 - 局域网（LAN）：局域网是一种较小区域范围的网络。比如公司内局域网或学校局域网。 - 广域网（WAN）：广域网通过路由器或其它公共通信链..."
tags:
  - "HTML"
  - "网络"
  - "TCP"
categories:
  - "编程基础"
keywords:
  - "编程"
  - "网络"
  - "TCP"
  - "技术博客"
  - "编程码农"
author: "编程码农"
draft: false
---

# 概述

## 网络

网络由两台或多台计算机组成，它们相互连接后共享资源、交换文件或进行电子通信。网络上的计算机可以通过电缆、电话线、无线电波、卫星或红外光束连接起来。

- 局域网（LAN）：局域网是一种较小区域范围的网络。比如公司内局域网或学校局域网。
- 广域网（WAN）：广域网通过路由器或其它公共通信链路将各个局域网相互连接的网络。



## 互联网

互联网把多种不同网络连接起来，也叫网络的网络，它是广域网的典型例子。互联网（Internet）是通常是指全球范围的互联网。



## ISP

互联网服务提供商（Internet service provider）从互联网管理机构获得许多 IP 地址，同时拥有通信线路以及路由器等联网设备，个人或机构向ISP缴费分配IP后，就可以连接到互联网，国内的ISP就是中国电信、移动、联通等。

IPS分主干ISP、地区ISP、本地ISP，两个网络之间可以通过IXP（Internet Exchange Point）交换直接互连。

![ips](https://blogs-on.oss-cn-beijing.aliyuncs.com/imgs/202206171526577.png)

# 网络协议

## 网络分层模型

![网络分层模型](https://blogs-on.oss-cn-beijing.aliyuncs.com/imgs/202206171705615.png)



## OSI 7 层协议

### 应用层

为特定应用程序提供数据传输服务。例如：HTTP、HTTPS、FTP、Telnet、SSH、SMTP、POP3等。

> **重点知识**：
>
> - **数据传输基本单位为报文；**
> - **包含的主要协议：FTP（文件传送协议）、Telnet（远程登录协议）、DNS（域名解析协议）、SMTP（邮件传送协议），POP3协议（邮局协议），HTTP协议（Hyper Text Transfer Protocol）。**

### 表示层

把数据转换为能与接收者的系统格式兼容并适合传输的格式，进行数据压缩、加密以及数据描述，这使得应用程序不必关心在各台主机中数据内部格式不同的问题。

### 会话层

负责在数据传输中设置和维护计算机网络中两台计算机之间的通信连接。

### **传输层**

为进程提供通用数据传输服务。由于应用层协议很多，定义通用的传输层协议就可以支持不断增多的应用层协议。传输层包括TCP/UDP两种协议，TCP提供面向连接、可靠的数据传输服务；UDP提供无连接、尽最大努力的数据传输服务。

> **重点知识**：传输层则负责将数据可靠地传送到相应的端口。
>
> - **传输层负责将上层数据分段并提供端到端的、可靠的或不可靠的传输以及端到端的差错控制和流量控制问题；**
> - **包含的主要协议：TCP协议（Transmission Control Protocol，传输控制协议）、UDP协议（User Datagram Protocol，用户数据报协议）；**
> - **相关设备：网关。**

### **网络层**

为主机提供数据传输服务。传输层协议是为主机中的进程提供数据传输服务。网络层决定数据的路径选择和转寄，将网络表头（NH）加至数据包，以形成分组。例如:互联网协议（IP）等。

> **重点知识**： 网络层负责对子网间的数据包进行路由选择。此外，网络层还可以实现拥塞控制、网际互连等功能
>
> - **基本数据单位为IP数据报；**
> - **包含的主要协议：**
> - **IP协议（Internet Protocol，因特网互联协议）;**
> - **ICMP协议（Internet Control Message Protocol，因特网控制报文协议）;**
> - **ARP协议（Address Resolution Protocol，地址解析协议）;**
> - **RARP协议（Reverse Address Resolution Protocol，逆地址解析协议）。**
> - **相关设备：路由器**



### **数据链路层**

负责物理地址寻址、数据的成帧、流量控制、数据的检错、重发。网络层针对的还是主机之间的数据传输服务，而主机之间可以有很多链路，链路层协议就是为同一链路的主机提供数据传输服务。

> **重点知识**：**数据链路层为网络层提供可靠的数据传输，基本数据单位为帧，以太网协议，相关设备网桥和交换机。**



### **物理层** 

在局域网上发送数据帧，负责管理电脑通信设备和网络媒体之间的互通。物理层的作用是尽可能屏蔽传输媒体和通信手段的差异，使数据链路层感觉不到这些差异。



## IP地址

IP 分两类IPv4和IPv6

### 网络广播地址

IP地址由网络号（包括子网号）和主机号组成，网络地址的主机号为全0，网络地址代表着整个网络。

广播地址与网络地址的主机号正好相反，广播地址中，主机号为全1。当向某个网络的广播地址发送消息时，该网络内的所有主机都能收到该广播消息。

### 四类IPv4地址

| 分类                | 前缀码 | 结束**地址**    |
| :------------------ | :----- | :-------------- |
| A**类地址**         | 0      | 127.255.255.255 |
| B**类地址**         | 10     | 191.255.255.255 |
| C**类地址**         | 110    | 223.255.255.255 |
| D**类地址**（群播） | 1110   | 239.255.255.255 |

### 255.255.255.255

该IP地址指的是受限的广播地址。受限广播地址只能用于本地网络，路由器不会转发以受限广播地址为目的地址的分组。

### 0.0.0.0

常用于寻找自己的IP地址，例如在我们的RARP，BOOTP和DHCP协议中，若某个未知IP地址的无盘机想要知道自己的IP地址，它就以255.255.255.255为目的地址，向本地范围（具体而言是被各个路由器屏蔽的范围内）的服务器发送IP请求分组。

### 回环地址

127.0.0.0/8 被用作回环地址，回环地址表示本机的地址，常用于对本机的测试，用的最多的是127.0.0.1。



> 子网掩码及网络划分单独主题



### ARP/RARP协议

**地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP/IP协议。**

### 路由选择协议

常见的路由选择协议有：RIP协议、OSPF协议。

**RIP**协议 ：底层是贝尔曼福特算法，它选择路由的度量标准（metric)是跳数，最大跳数是15跳，如果大于15跳，它就会丢弃数据包。

**OSPF**协议 ：Open Shortest Path First开放式最短路径优先，底层是迪杰斯特拉算法，是链路状态路由选择协议，它选择路由的度量标准是带宽，延迟。



## TCP/IP

**TCP/IP协议是Internet最基本的协议、Internet国际互联网络的基础，由网络层的IP协议和传输层的TCP协议组成。通俗而言：TCP负责发现传输的问题，一有问题就发出信号，要求重新传输，直到所有数据安全正确地传输到目的地。而IP是给因特网的每一台联网设备规定一个地址。**

TCP/IP 不考虑格式化和呈现数据的细节，不严格遵循 OSI 分层概念，没有表示层和会话层，应用层可能会直接使用 IP 层或者网络接口层。

TCP 首部格式

![img](https://blogs-on.oss-cn-beijing.aliyuncs.com/imgs/202206211641554.png)

**TCP协议的三次握手和四次挥手：**

![img](https://blogs-on.oss-cn-beijing.aliyuncs.com/imgs/202206211642604.gif)



> **注：seq**:"sequance"序列号；**ack**:"acknowledge"确认号；**SYN**:"synchronize"请求同步标志；**；ACK**:"acknowledge"确认标志"**；**

**TCP连接建立过程：**首先Client端发送连接请求报文，Server段接受连接后回复ACK报文，并为这次连接分配资源。Client端接收到ACK报文后也向Server段发生ACK报文，并分配资源，这样TCP连接就建立了。

**TCP连接断开过程：**假设Client端发起中断连接请求，也就是发送FIN报文。Server端接到FIN报文后，意思是说"我Client端没有数据要发给你了"，但是如果你还有数据没有发送完成，则不必急着关闭Socket，可以继续发送数据。所以你先发送ACK，"告诉Client端，你的请求我收到了，但是我还没准备好，请继续你等我的消息"。这个时候Client端就进入FIN_WAIT状态，继续等待Server端的FIN报文。当Server端确定数据已发送完成，则向Client端发送FIN报文，"告诉Client端，好了，我这边数据发完了，准备好关闭连接了"。Client端收到FIN报文后，"就知道可以关闭连接了，但是他还是不相信网络，怕Server端不知道要关闭，所以发送ACK后进入TIME_WAIT状态，如果Server端没有收到ACK则可以重传。"，Server端收到ACK后，"就知道可以断开连接了"。Client端等待了2MSL后依然没有收到回复，则证明Server端已正常关闭，那好，我Client端也可以关闭连接了。Ok，TCP连接就这样关闭了！



**为什么要三次握手？**

在只有两次"握手"的情形下，假设Client想跟Server建立连接，但是却因为中途连接请求的数据报丢失了，故Client端不得不重新发送一遍；这个时候Server端仅收到一个连接请求，因此可以正常的建立连接。但是，有时候Client端重新发送请求不是因为数据报丢失了，而是有可能数据传输过程因为网络并发量很大在某结点被阻塞了，这种情形下Server端将先后收到2次请求，并持续等待两个Client请求向他发送数据...问题就在这里，Cient端实际上只有一次请求，而Server端却有2个响应，极端的情况可能由于Client端多次重新发送请求数据而导致Server端最后建立了N多个响应在等待，因而造成极大的资源浪费！所以，"三次握手"很有必要！

**为什么要四次挥手？**

试想一下，假如现在你是客户端你想断开跟Server的所有连接该怎么做？第一步，你自己先停止向Server端发送数据，并等待Server的回复。但事情还没有完，虽然你自身不往Server发送数据了，但是因为你们之前已经建立好平等的连接了，所以此时他也有主动权向你发送数据；故Server端还得终止主动向你发送数据，并等待你的确认。其实，说白了就是保证双方的一个合约的完整执行！

使用TCP的协议：FTP（文件传输协议）、Telnet（远程登录协议）、SMTP（简单邮件传输协议）、POP3（和SMTP相对，用于接收邮件）、HTTP协议等。



# UDP协议

**UDP用户数据报协议，是面向无连接的通讯协议，UDP数据包括目的端口号和源端口号信息，由于通讯不需要连接，所以可以实现广播发送。**

UDP通讯时不需要接收方确认，属于不可靠的传输，可能会出现丢包现象，实际应用中要求程序员编程验证。

UDP与TCP位于同一层，但它不管数据包的顺序、错误或重发。因此，UDP不被应用于那些使用虚电路的面向连接的服务，UDP主要用于那些面向查询---应答的服务，例如NFS。相对于FTP或Telnet，这些服务需要交换的信息量较小。

每个UDP报文分UDP报头和UDP数据区两部分。报头由四个16位长（2字节）字段组成，分别说明该报文的源端口、目的端口、报文长度以及校验值。UDP报头由4个域组成，其中每个域各占用2个字节，具体如下：

- 源端口号；
- 目标端口号；
- 数据报长度；
- 校验值。

使用UDP协议包括：TFTP（简单文件传输协议）、SNMP（简单网络管理协议）、DNS（域名解析协议）、NFS、BOOTP。

**TCP** **与** **UDP** **的区别：**TCP是面向连接的，可靠的字节流服务；UDP是面向无连接的，不可靠的数据报服务。



# DNS协议

DNS是域名系统(DomainNameSystem)的缩写，该系统用于命名组织到域层次结构中的计算机和网络服务，**可以简单地理解为将URL转换为IP地址**。域名是由圆点分开一串单词或缩写组成的，每一个域名都对应一个惟一的IP地址，在Internet上域名与IP地址之间是一一对应的，DNS就是进行域名解析的服务器。DNS命名用于Internet等TCP/IP网络中，通过用户友好的名称查找计算机和服务。



# NAT协议

　　NAT网络地址转换(Network Address Translation)属接入广域网(WAN)技术，是一种将私有（保留）地址转化为合法IP地址的转换技术，它被广泛应用于各种类型Internet接入方式和各种类型的网络中。原因很简单，NAT不仅完美地解决了lP地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机。



# DHCP协议

DHCP动态主机设置协议（Dynamic Host Configuration Protocol）是一个局域网的网络协议，使用UDP协议工作，主要有两个用途：给内部网络或网络服务供应商自动分配IP地址，给用户或者内部网络管理员作为对所有计算机作中央管理的手段。



# HTTP协议

超文本传输协议（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。所有的WWW文件都必须遵守这个标准。**HTTP** **协议包括哪些请求？**

GET：请求读取由URL所标志的信息。

POST：给服务器添加信息（如注释）。

PUT：在给定的URL下存储一个文档。

DELETE：删除给定的URL所标志的资源。

**HTTP** **中，** **POST** **与** **GET** **的区别**

- Get是从服务器上获取数据，Post是向服务器传送数据。
- Get是把参数数据队列加到提交表单的Action属性所指向的URL中，值和表单内各个字段一一对应，在URL中可以看到。
- Get传送的数据量小，不能大于2KB；Post传送的数据量较大，一般被默认为不受限制。
- 根据HTTP规范，GET用于信息获取，而且应该是安全的和幂等的。

- I. 所谓 **安全的** 意味着该操作用于获取信息而非修改信息。换句话说，GET请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。
- II. **幂等** 的意味着对同一URL的多个请求应该返回同样的结果。



# 面试

在浏览器中输入 **http://www.baidu.com/** 后执行的全部过程。

现在假设如果我们在客户端（客户端）浏览器中输入 http://www.baidu.com， 而 baidu.com 为要访问的服务器（服务器），下面详细分析客户端为了访问服务器而执行的一系列关于协议的操作：

- 1）客户端浏览器通过DNS解析到www.baidu.com的IP地址220.181.27.48，通过这个IP地址找到客户端到服务器的路径。客户端浏览器发起一个HTTP会话到220.161.27.48，然后通过TCP进行封装数据包，输入到网络层。
- 2）在客户端的传输层，把HTTP会话请求分成报文段，添加源和目的端口，如服务器使用80端口监听客户端的请求，客户端由系统随机选择一个端口如5000，与服务器进行交换，服务器把相应的请求返回给客户端的5000端口。然后使用IP层的IP地址查找目的端。
- 3）客户端的网络层不用关系应用层或者传输层的东西，主要做的是通过查找路由表确定如何到达服务器，期间可能经过多个路由器，这些都是由路由器来完成的工作，不作过多的描述，无非就是通过查找路由表决定通过那个路径到达服务器。
- 4）客户端的链路层，包通过链路层发送到路由器，通过邻居协议查找给定IP地址的MAC地址，然后发送ARP请求查找目的地址，如果得到回应后就可以使用ARP的请求应答交换的IP数据包现在就可以传输了，然后发送IP数据包到达服务器的地址。



# 参考

https://www.runoob.com/w3cnote/summary-of-network.html#_label1

https://en.wikipedia.org/wiki/Internet_protocol_suite
